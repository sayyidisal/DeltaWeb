!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Minislate=e()}}(function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){var o=e("./util"),i=o.Class,r=o.extend,a=i(Object,{init:function(){this.controls={}},addControl:function(e,t,n){throw new Error("Not implemented")},removeControl:function(e){this.controls[e]&&delete this.controls[e]}}),s=i(Object,{defaults:{label:null,title:"",classes:"",fontAwesomeID:null},classes:[],init:function(e,t,n){this.options=r({},this.defaults,n||{}),this.toolbar=e,this.id=t,this.label=this.options.label||this.id,this.element=this._initElement(),this.setLabel(),this.element.setAttribute("title",this.options.title),this.options.classes&&this.classes.push.apply(this.classes,this.options.classes.split(/\s+/));for(var o=0;o<this.classes.length;o++)this.element.classList.add(this.toolbar._getClassName(this.classes[o]));var i=this;this.toolbar.element.addEventListener("toolbar.show",function(){i.setVisibility(),i.setHighlight()})},_initElement:function(){throw new Error("_initElement not implemented")},drawElement:function(e){return e=e||document.createElement("li"),e.appendChild(this.element),e},setLabel:function(e,t){for(e=e||this.label,t=t||this.options.fontAwesomeID;this.element.firstChild;)this.element.removeChild(this.element.firstChild);var n=document.createTextNode(e);if(this.toolbar.options.fontAwesomeEnabled&&t){var o=this.getFaElement(t),i=document.createElement("span");i.appendChild(n),o.appendChild(i),this.element.appendChild(o)}else this.element.appendChild(n)},isHighlighted:function(){return!1},isVisible:function(){return!0},setVisibility:function(e){e="undefined"!=typeof e?e:this.isVisible(),e?this.element.parentNode.style.display="block":this.element.parentNode.style.display="none"},setHighlight:function(e){e="undefined"!=typeof e?e:this.isHighlighted();var t=this.toolbar._getClassName("highlight");e?this.element.classList.contains(t)||this.element.classList.add(t):this.element.classList.remove(t)},getFaElement:function(e){var t=document.createElement("i");return t.classList.add("fa","fa-"+e),t}}),l=i(s,{classes:["button"],init:function(e,t,n){s.prototype.init.call(this,e,t,n);var o=this;this.element.addEventListener("click",function(e){o.click(e)})},_getParentElement:function(){var e=s.prototype._getParentElement.call(this);return e.classList.add(this.toolbar._getClassName("button")),e},_initElement:function(){return document.createElement("button")},drawElement:function(){var e=document.createElement("li");return e.classList.add(this.toolbar._getClassName("button")),s.prototype.drawElement.call(this,e)},click:function(){}}),c=i(s,{defaults:r({},s.prototype.defaults,{controls:[]}),classes:["button"],closeDelay:400,init:function(e,t,n){a.prototype.init.call(this),s.prototype.init.call(this,e,t,n);for(var o,i,r,l=0;l<this.options.controls.length;l++)o=this.options.controls[l][0],i=this.options.controls[l][1],r=this.options.controls[l][2],this.addControl(o,i,r);this.container=document.createElement("ul"),this.container.classList.add(this.toolbar._getClassName("controls")),this.container.style.display="none";var c=this,d=function(){c._open()},u=function(){c._closetimer()},f=function(){c._canceltimer()};this.toolbar.element.addEventListener("toolbar.show",function(){c._close(),c.element.removeEventListener("mouseover",d),c.element.removeEventListener("mouseout",u),c.container.removeEventListener("mouseover",f),c.container.removeEventListener("mouseout",u),setTimeout(function(){c.element.addEventListener("mouseover",d),c.element.addEventListener("mouseout",u),c.container.addEventListener("mouseover",f),c.container.addEventListener("mouseout",u)},200)})},_open:function(){var e,t;for(t in this.toolbar.controls)e=this.toolbar.controls[t],e instanceof c&&(e._canceltimer(),e._close());this._canceltimer(),this.container.style.display="block"},_close:function(){this.container.style.display="none"},_closetimer:function(){var e=this;this.closeTimeout=setTimeout(function(){e._close()},this.closeDelay)},_canceltimer:function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},_initElement:function(){return document.createElement("button")},isHighlighted:function(){var e,t;for(t in this.controls)if(e=this.controls[t],e.id,e.isHighlighted())return this.setLabel(e.label,e.options.fontAwesomeID),!0;return!1},drawElement:function(){var e=document.createElement("li");return e.classList.add(this.toolbar._getClassName("menu")),e=s.prototype.drawElement.call(this,e),e.appendChild(this.container),this.drawControls(),e},setLabel:function(e,t){s.prototype.setLabel.call(this,e,t),this.element.appendChild(document.createTextNode(" "));var n;this.toolbar.options.fontAwesomeEnabled?n=this.getFaElement("chevron-down"):(n=document.createElement("span"),n.classList.add(this.toolbar._getClassName("menu-arrow")),n.appendChild(document.createTextNode("↓"))),this.element.appendChild(n)},addControl:function(e,t,n){this.controls[t]=new e(this.toolbar,t,n),this.toolbar._dirty=!0},removeControl:function(e){this.controls[e]&&(a.prototype.removeControl.call(this,e),this.toolbar._dirty=!0)},drawControls:function(){for(var e,t,n;this.container.firstChild;)this.container.removeChild(this.container.firstChild);for(t in this.controls)if(e=this.controls[t],n=e.drawElement(),e.setLabel(),this.container.appendChild(n),e.options.title){var o=document.createElement("em"),i=document.createTextNode(" - "+e.options.title);o.appendChild(i),n.firstChild.appendChild(o)}}}),d=i(Object,{init:function(e){this.control=e,this.toolbar=e.toolbar,this.element=e.toolbar.dialog},addTextField:function(e,t){var n={size:30,enter:null,escape:null};t=r({},n,t||{});var o=document.createElement("input"),i=document.createElement("label");return i.appendChild(document.createTextNode(e)),o.setAttribute("size",t.size),o.setAttribute("type","text"),i.appendChild(o),this.element.appendChild(i),(t.enter||t.escape)&&o.addEventListener("keyup",function(e){t.escape&&27===e.which?t.escape.call(o,e):t.enter&&13===e.which&&t.enter.call(o,e)}),o},addButton:function(e,t){var n={click:null,fontAwesomeID:null};t=r({},n,t||{});var o=document.createElement("button");if(o.appendChild(document.createTextNode(e)),this.element.appendChild(document.createTextNode(" ")),this.element.appendChild(o),this.element.appendChild(document.createTextNode(" ")),t.click&&"function"==typeof t.click&&o.addEventListener("click",t.click),t.fontAwesomeID&&this.toolbar.options.fontAwesomeEnabled){o.removeChild(o.firstChild),o.setAttribute("title",e);var i=s.prototype.getFaElement.call(null,t.fontAwesomeID);o.appendChild(i)}return o}});n.ControlsMixin=a,n.BaseControl=s,n.Button=l,n.Menu=c,n.Dialog=d},{"./util":9}],2:[function(e,t,n){var o=e("../util"),i=e("../controls"),r=e("../../vendor/rangy/core").api,a=o.Class,s=o.extend,l=o._,c=i.Button,d=a(c,{tagList:[],tag:null,command:"formatblock",defaults:s({},c.prototype.defaults),init:function(){c.prototype.init.apply(this,arguments),this.BLOCK_NODES=l.filter(this.toolbar.editor.BLOCK_NODES,function(e){return-1===["ul","ol"].indexOf(e.toLowerCase())})},isHighlighted:function(){return this.toolbar.editor.filterTopNodeNames.apply(this.toolbar.editor,this.tagList).length>0},click:function(){var e,t=this.toolbar.editor;"formatblock"===this.command?(this.isHighlighted()||(e=t.filterTopNodeNames.apply(t,this.BLOCK_NODES),e.length>0&&t.setRange(e[0])),this.toolbar.editor.exec(this.command,"<"+this.tag+">")):this.toolbar.editor.exec(this.command),this.toolbar.editor.showToolbar()}});n.Block=d,n.Paragraph=a(d,{tagList:["p"],tag:"p",command:"formatblock",defaults:s({},d.prototype.defaults,{label:"¶",title:"Paragraph"})});for(var u=1;6>=u;u++){var f=a(d,{tagList:["h"+u],tag:"h"+u,defaults:s({},d.prototype.defaults,{label:"H"+u,title:"Title level "+u})});n["H"+u]=f}n.Preformated=a(d,{tagList:["pre"],tag:"pre",defaults:s({},d.prototype.defaults,{label:"<>",title:"Code",fontAwesomeID:"code",tabReplacement:"    "}),init:function(){d.prototype.init.apply(this,arguments);var e=this,t=this.toolbar.editor;t.on("keydown",function(n){9!==n.which||n.ctrlKey||n.metaKey||n.shiftKey||t.filterTopNodeNames("pre").length>0&&(n.preventDefault(),t.exec("insertHtml",e.options.tabReplacement))})},click:function(){d.prototype.click.call(this);var e=this.toolbar.editor,t=e.getEnclosingNode(),n=[].slice.call(t.getElementsByTagName("br"));l.each(n,function(e){e.parentNode.insertBefore(document.createTextNode("\n"),e),e.parentNode.removeChild(e)})}});var h=a(d,{init:function(){d.prototype.init.apply(this,arguments);var e=this,t=this.toolbar.editor;t.on("keydown",function(n){if(9===n.which&&!n.ctrlKey&&!n.metaKey){var o=t.filterTopNodeNames("ul","ol");if(0===o.length||o[0].nodeName.toLowerCase()!==e.tag)return;n.preventDefault(),n.shiftKey?t.exec("outdent"):t.exec("indent")}})},click:function(){var e=this.toolbar.editor,t=e.filterTopNodeNames("ul","ol");if(t.length>0){if(t[0].nodeName.toLowerCase()===this.tag)return;var n=t[0],o=r.saveSelection(),i=document.createElement(this.tag);n.parentNode.insertBefore(i,n),l.each([].slice.call(n.childNodes),function(e){i.appendChild(e)}),n.parentNode.removeChild(n),r.restoreSelection(o),r.removeMarkers(o),e.showToolbar()}else d.prototype.click.call(this)}});n.UnorderedList=a(h,{tagList:["ul"],tag:"ul",command:"insertunorderedlist",defaults:s({},h.prototype.defaults,{label:"UL",title:"Unordered list",fontAwesomeID:"list-ul"})}),n.OrderedList=a(h,{tagList:["ol"],tag:"ol",command:"insertorderedlist",defaults:s({},h.prototype.defaults,{label:"OL",title:"Ordered list",fontAwesomeID:"list-ol"})}),n.Blockquote=a(d,{tagList:["blockquote"],defaults:s({},d.prototype.defaults,{label:"Quote",title:"Quote",fontAwesomeID:"quote-right"}),init:function(){d.prototype.init.apply(this,arguments);var e=this,t=this.toolbar.editor;t.on("keyup",function(e){if(13===e.which&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){var n=t.filterTopNodeNames("blockquote");if(0===n.length||!t.getSelection().isCollapsed)return;var o=n[0];if(n=t.filterTopNodeNames("p"),0===n.length)return;n=n[0],n.previousSibling&&""===n.previousSibling.textContent&&(n.previousSibling.parentNode.removeChild(n.previousSibling),o.parentNode.insertBefore(n,o.nextSibling),t.setRange(n),t.getSelection().collapse(n))}}),t.on("keydown",function(n){if(9===n.which&&!n.ctrlKey&&!n.metaKey){var o=t.filterTopNodeNames("blockquote");if(0===o.length)return;n.preventDefault(),n.shiftKey?e.removeBlockquote():e.insertBlockquote()}})},click:function(){var e=this.toolbar.editor,t=e.getSelection();t.isCollapsed&&0===e.getTopNodes().length||(e.filterTopNodeNames("blockquote").length>0?this.removeBlockquote():this.insertBlockquote(),e.showToolbar())},insertBlockquote:function(){var e=this.toolbar.editor,t=e.filterTopNodeNames.apply(e,e.BLOCK_NODES),n=t.length>0?t[0]:null,o=e.getSurroundingNodes(function(t){return-1!==e.BLOCK_NODES.indexOf(t.nodeName.toUpperCase())});t=o.length>0?o:n?[n]:e.getSurroundingNodes(),e.setRange(t[0],t[t.length-1]),t=e.getSurroundingNodes();var i=document.createElement("blockquote");t[0].parentNode.insertBefore(i,t[0]),l.each(t,i.appendChild,i),e.setRange(i)},removeBlockquote:function(){var e=this.toolbar.editor.filterTopNodeNames("blockquote"),t=r.saveSelection();r.dom.replaceNodeByContents(e[0]),r.restoreSelection(t),r.removeMarkers(t)}})},{"../../vendor/rangy/core":11,"../controls":1,"../util":9}],3:[function(e,t,n){var o=e("../util"),i=e("../controls"),r=e("../../vendor/rangy/core").api,a=o.Class,s=o.extend,l=o._,c=i.Button,d=i.Dialog,u=a(c,{tagList:[],command:null,isHighlighted:function(){return this.toolbar.editor.filterTopNodeNames.apply(this.toolbar.editor,this.tagList).length>0},isVisible:function(){return!this.toolbar.editor.getSelection().isCollapsed||this.isHighlighted()},click:function(){var e=this.toolbar.editor;if(e.getSelection().isCollapsed){var t=e.filterTopNodeNames.apply(e,this.tagList);if(0===t.length)return;t=t[0],e.setRange(t)}e.exec(this.command),e.showToolbar()}});n.Inline=u,n.Bold=a(u,{defaults:s({},u.prototype.defaults,{label:"B",title:"Bold",fontAwesomeID:"bold"}),tagList:["b","strong"],command:"bold",init:function(){u.prototype.init.apply(this,arguments);var e=this,t=this.toolbar.editor;t.on("keydown",function(t){66===t.which&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.click())})}}),n.Italic=a(u,{defaults:s({},u.prototype.defaults,{label:"I",title:"Italic",fontAwesomeID:"italic"}),tagList:["i","em"],command:"italic",init:function(){u.prototype.init.apply(this,arguments);var e=this,t=this.toolbar.editor;t.on("keydown",function(t){73===t.which&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.click())})}}),n.Underline=a(u,{defaults:s({},u.prototype.defaults,{label:"U",title:"Underline",fontAwesomeID:"underline"}),tagList:["u","ins"],command:"underline"}),n.StrikeThrough=a(u,{defaults:s({},u.prototype.defaults,{label:"S",title:"Strike-Through",fontAwesomeID:"strikethrough"}),tagList:["strike","del"],command:"strikeThrough"});var f=a(d,{show:function(e){var t=this.control,n=this.toolbar.editor,o=r.saveSelection();n.showDialog(function(){i.focus()});var i=this.addTextField("URL: ",{escape:function(){n.restoreSelection(o)},enter:function(i){n.restoreSelection(o),t.saveLink(e,i.target.value)}});this.addButton("Save",{fontAwesomeID:"check",click:function(r){r.stopImmediatePropagation(),n.restoreSelection(o),t.saveLink(e,i.value)}}),e&&(i.value=e.getAttribute("href"),this.addButton("Remove",{fontAwesomeID:"chain-broken",click:function(i){i.stopImmediatePropagation(),n.restoreSelection(o),t.saveLink(e,null)}}))}});n.Link=a(c,{defaults:s({},c.prototype.defaults,{label:"#",base_title:"Link",title:"",fontAwesomeID:"link"}),init:function(){c.prototype.init.apply(this,arguments);var e=this,t=this.toolbar.editor;t.on("keydown",function(t){75===t.which&&t.shiftKey&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.click())})},isHighlighted:function(){var e=this.options.base_title,t=this.toolbar.editor.filterTopNodeNames("a");return t.length>0&&(e+=": "+t[0].href),this.element.setAttribute("title",e),t.length>0},isVisible:function(){return!this.toolbar.editor.getSelection().isCollapsed||this.isHighlighted()},click:function(){var e=this.toolbar.editor,t=e.getSelection().isCollapsed,n=e.filterTopNodeNames("a");t&&0===n.length||(n=0===n.length?null:n[0],t&&e.setRange(n),new f(this).show(n))},saveLink:function(e,t){var n=this.toolbar.editor,o=n.getRange();if(e)if(t)e.setAttribute("href",t),n.setRange(e);else{var i=r.saveSelection();r.dom.replaceNodeByContents(e,!0),r.restoreSelection(i),r.removeMarkers(i)}else if(t){e=document.createElement("a"),e.setAttribute("href",t);var a=o.cloneContents();l.each(a.childNodes,function(t){e.appendChild(t.cloneNode(!0))}),o.deleteContents(),o.insertNode(e),n.setRange(e)}return n.showToolbar(),e}})},{"../../vendor/rangy/core":11,"../controls":1,"../util":9}],4:[function(e,t,n){var o=e("../util"),i=e("../controls"),r=e("../../vendor/rangy/core").api,a=o.Class,s=o.extend,l=i.Button,c=i.Dialog,d=a(c,{show:function(e){var t=this.control,n=this.toolbar.editor,o=r.saveSelection();n.showDialog(function(){i.focus()});var i=this.addTextField("URL: ",{escape:function(){n.restoreSelection(o)},enter:function(i){n.restoreSelection(o),t.saveImage(e,i.target.value)}});this.addButton("Save",{fontAwesomeID:"check",click:function(r){r.stopImmediatePropagation(),n.restoreSelection(o),t.saveImage(e,i.value)}}),e&&(i.value=e.getAttribute("src"))}});n.Image=a(l,{defaults:s({},l.prototype.defaults,{label:"IMG",title:"Image",fontAwesomeID:"picture-o"}),init:function(){l.prototype.init.apply(this,arguments);var e=this.toolbar.editor;e.on("click",function(t){"img"===t.target.tagName.toLowerCase()&&(e.setRange(t.target),e.showToolbar())})},isHighlighted:function(){return this.toolbar.editor.filterTopNodeNames("img").length>0},click:function(){var e=this.toolbar.editor,t=e.filterTopNodeNames("img");t=0===t.length?null:t[0],new d(this).show(t)},saveImage:function(e,t){var n=this.toolbar.editor,o=n.getRange();return e&&t?(e.setAttribute("src",t),n.setRange(e)):t&&(e=document.createElement("img"),e.setAttribute("src",t),o.deleteContents(),o.insertNode(e),n.cleanBlock(e.parentNode),n.setRange(e)),n.showToolbar(),e}})},{"../../vendor/rangy/core":11,"../controls":1,"../util":9}],5:[function(e,t,n){var o=e("../vendor/rangy/core").api,i=e("./util").extend,r=e("./util").Class,a=e("./toolbar").Toolbar,s=e("./util")._,l=e("./html-cleaner").HtmlCleaner,c=r(Object,{defaults:{delay:300,diffLeft:2,diffTop:-10,classPrefix:"editor-",fontAwesomeEnabled:!0},BLOCK_NODES:"P H1 H2 H3 H4 H5 H6 UL OL PRE DL DIV NOSCRIPT BLOCKQUOTE FORM HR TABLE FIELDSET ADDRESS".split(" "),init:function(e,t){if(!window.getSelection)throw new Error("Browser features missing.");"object"==typeof e&&(this.element=e,o.initialized||o.init(),this.isActive=!0,this.isSelected=!1,this.options=i({},this.defaults,t),this._currentEditor=null,this._resizeHandler=function(e){var t=null;return function(){clearTimeout(t),t=setTimeout(function(){e.setToolbarPosition()},250)}}(this),this.initElement().initToolbar().bindSelect().bindTyping())},on:function(e,t){this.element.addEventListener(e,t)},off:function(e,t){this.element.removeEventListener(e,t)},initElement:function(){var e=this;return this.element.setAttribute("contentEditable",!0),this.element.setAttribute("data-editor-element",!0),this.on("focus",function(){e._onFocus()}),this},bindSelect:function(){var e=this,t=null,n=function(n){clearTimeout(t),t=setTimeout(function(){e._onSelect(n)},e.options.delay)};return document.addEventListener("mouseup",n),document.addEventListener("keyup",n),this},bindTyping:function(){var e=this;return this.on("keyup",function(t){var n=e.getSelection();9!==t.which&&n.isCollapsed&&n.getEnclosingNode()===e._currentEditor&&e.exec("formatBlock","p")}),this},initToolbar:function(){var e=this;return this.toolbar=new a(this,{classPrefix:this.options.classPrefix,fontAwesomeEnabled:this.options.fontAwesomeEnabled}),this.toolbar.element.addEventListener("toolbar.show",function(){e.focus()}),this.toolbar.element.addEventListener("toolbar.hide",function(){var t=e.element.querySelectorAll("span.rangySelectionBoundary");s.each(t,function(e){e.parentNode.removeChild(e)})}),this},exec:function(e,t){document.execCommand(e,!1,t)},focus:function(){this._currentEditor&&this._currentEditor.focus()},showToolbar:function(){return this.toolbar.hideDialog(),this.toolbar.show(),this.setToolbarPosition(),window.addEventListener("resize",this._resizeHandler),this},hideToolbar:function(){return window.removeEventListener("resize",this._resizeHandler),this.toolbar.hide(),this},showDialog:function(e){var t=this;return this.toolbar.showDialog(),setTimeout(function(){t.setToolbarPosition(),"function"==typeof e&&e.call(t)},20),this},setToolbarPosition:function(){var e,t=this.getSelection(),n=this.getRange(),i=t.getEnclosingNode(),r=this.toolbar.element.offsetHeight,a=this.toolbar.element.offsetWidth;if(!t.isCollapsed&&o.util.isHostMethod(n.nativeRange,"getBoundingClientRect"))e=n.nativeRange.getBoundingClientRect();else{for(;1===i.parentNode.childNodes.length;)i=i.parentNode;e=i.getBoundingClientRect()}var s=0;s=e.top<r?e.bottom-this.options.diffTop+window.pageYOffset:e.top+this.options.diffTop+window.pageYOffset-r;var l=e.left-this.options.diffLeft;this._currentEditor.offsetWidth<a+e.left&&(l=e.right-a+this.options.diffLeft),this.toolbar.move(s,l)},restoreSelection:function(e,t){t="undefined"==typeof t?!0:t,o.restoreSelection(e),o.removeMarkers(e),this.element.focus(),t&&this.showToolbar()},_onFocus:function(){this._currentEditor=this.element},_onSelect:function(e){var t=[this.element,this.toolbar.element];return o.dom.hasParents(e.target,t)?(this._currentEditor=this.element,o.dom.hasParents(e.target,[this.toolbar.element])||this.showToolbar(),void(this.isSelected||(this.isSelected=!0,9===e.which&&this.selectStart()))):void(this.isSelected&&(this.hideToolbar(),this._currentEditor=null,this.isSelected=!1))},selectStart:function(){var e=this.getSelection();if(e.isCollapsed){this.element.childNodes.length>0&&3===this.element.firstChild.nodeType&&""===this.element.firstChild.textContent.replace(/^\s*(.*?)\s*$/,"$1")&&this.element.removeChild(this.element.firstChild);var t,n;if(this.element.childNodes.length>0?(t=this.element.firstChild,n=o.dom.getNodes(t,3),n.length>0&&(t=n[0])):(t=document.createElement("p"),this.element.appendChild(t),t.appendChild(document.createTextNode("")),t=t.firstChild),3===t.nodeType){var i=o.createRange();i.setStart(t,0),this.getSelection().setSingleRange(i)}else this.setRange(t);this.showToolbar()}},getSelection:function(){return o.getSelection()},getRange:function(e){return e="undefined"==typeof e?0:e,this.getSelection().getRangeAt(0)},setRange:function(e,t){if("undefined"!=typeof e){var n=o.createRange();n.selectNodeContents(e),t&&t!==e&&(t.lastChild?n.setEndAfter(t.lastChild):n.setEndAfter(t)),this.getSelection().setSingleRange(n)}},getEnclosingNode:function(){var e=this.getSelection();if(1!==e.rangeCount)return null;var t=e.getEnclosingNode();return t===this._currentEditor?null:t},getTopNodes:function(e){var t=this.getSelection();return 1!==t.rangeCount?[]:t.getTopNodes(this._currentEditor,e)},getSurroundingNodes:function(e){var t=this.getSelection();return 1!==t.rangeCount?[]:t.getSurroundingNodes(e)},filterTopNodeNames:function(){var e=s.map(arguments,function(e){return e.toLowerCase()});return this.getTopNodes(function(t){return-1!==e.indexOf(t.nodeName.toLowerCase())})},cleanBlock:function(e){var t=e.childNodes[e.childNodes.length-1];1===t.nodeType&&"br"===t.nodeName.toLowerCase()&&e.removeChild(t)},serialize:function(e){var t=this.element.innerHTML;if(e){var n=new l;t=n.clean(t)}return t}});n.Editor=c;var d={Menu:e("./controls").Menu,inline:e("./controls/inline"),block:e("./controls/block"),media:e("./controls/media")};n.controls=d,n.simpleEditor=r(c,{init:function(){c.prototype.init.apply(this,arguments),this.toolbar.addControl(d.Menu,"blocks",{label:"¶",title:"Blocks",controls:[[d.block.Paragraph,"p"],[d.block.H1,"h1"],[d.block.H2,"h2"],[d.block.H3,"h3"],[d.block.Preformated,"pre"]]}),this.toolbar.addControl(d.Menu,"lists",{label:"Lists",title:"Lists",fontAwesomeID:"list-ul",controls:[[d.block.UnorderedList,"ul"],[d.block.OrderedList,"ol"]]}),this.toolbar.addControl(d.block.Blockquote,"quote"),this.toolbar.addControl(d.inline.Bold,"bold"),this.toolbar.addControl(d.inline.Italic,"italic"),this.toolbar.addControl(d.inline.Underline,"underline"),this.toolbar.addControl(d.inline.StrikeThrough,"strike"),this.toolbar.addControl(d.inline.Link,"link"),this.toolbar.addControl(d.media.Image,"image"),this.toolbar.addControl(d.media.Oembed,"oembed")}})},{"../vendor/rangy/core":11,"./controls":1,"./controls/block":2,"./controls/inline":3,"./controls/media":4,"./html-cleaner":6,"./toolbar":8,"./util":9}],6:[function(e,t,n){var o=e("./util").Class,i=e("./util").extend,r=e("./util")._,a=o(Object,{defaults:{},init:function(e){this.options=i({},this.defaults,e)},formatRegexp:[[/(<[a-z][^>]*)margin\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)margin-bottom\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)margin-left\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)margin-right\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)margin-top\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)padding\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)padding-bottom\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)padding-left\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)padding-right\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)padding-top\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)font\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)font-family\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)font-size\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)font-style\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)font-variant\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)font-weight\s*:[^;]*;/gm,"$1"],[/(<[a-z][^>]*)color\s*:[^;]*;/gm,"$1"]],cleanRegexp:[[/<meta[\w\W]*?>/gim,""],[/<style[\w\W]*?>[\w\W]*?<\/style>/gim,""],[/<\/?font[\w\W]*?>/gim,""],[/<(\/?)(B|b|STRONG)([\s>\/])/g,"<$1strong$3"],[/<(\/?)(I|i|EM)([\s>\/])/g,"<$1em$3"],[/<IMG ([^>]*?[^\/])>/gi,"<img $1 />"],[/<INPUT ([^>]*?[^\/])>/gi,"<input $1 />"],[/<COL ([^>]*?[^\/])>/gi,"<col $1 />"],[/<AREA ([^>]*?[^\/])>/gi,"<area $1 />"],[/<PARAM ([^>]*?[^\/])>/gi,"<param $1 />"],[/<HR ([^>]*?[^\/])>/gi,"<hr $1/>"],[/<BR ([^>]*?[^\/])>/gi,"<br $1/>"],[/<(\/?)U([\s>\/])/gi,"<$1ins$2"],[/<(\/?)STRIKE([\s>\/])/gi,"<$1del$2"],[/<span style="font-weight: normal;">([\w\W]*?)<\/span>/gm,"$1"],[/<span style="font-weight: bold;">([\w\W]*?)<\/span>/gm,"<strong>$1</strong>"],[/<span style="font-style: italic;">([\w\W]*?)<\/span>/gm,"<em>$1</em>"],[/<span style="text-decoration: underline;">([\w\W]*?)<\/span>/gm,"<ins>$1</ins>"],[/<span style="text-decoration: line-through;">([\w\W]*?)<\/span>/gm,"<del>$1</del>"],[/<span style="text-decoration: underline line-through;">([\w\W]*?)<\/span>/gm,"<del><ins>$1</ins></del>"],[/<span style="(font-weight: bold; ?|font-style: italic; ?){2}">([\w\W]*?)<\/span>/gm,"<strong><em>$2</em></strong>"],[/<span style="(font-weight: bold; ?|text-decoration: underline; ?){2}">([\w\W]*?)<\/span>/gm,"<ins><strong>$2</strong></ins>"],[/<span style="(font-weight: italic; ?|text-decoration: underline; ?){2}">([\w\W]*?)<\/span>/gm,"<ins><em>$2</em></ins>"],[/<span style="(font-weight: bold; ?|text-decoration: line-through; ?){2}">([\w\W]*?)<\/span>/gm,"<del><strong>$2</strong></del>"],[/<span style="(font-weight: italic; ?|text-decoration: line-through; ?){2}">([\w\W]*?)<\/span>/gm,"<del><em>$2</em></del>"],[/<span style="(font-weight: bold; ?|font-style: italic; ?|text-decoration: underline; ?){3}">([\w\W]*?)<\/span>/gm,"<ins><strong><em>$2</em></strong></ins>"],[/<span style="(font-weight: bold; ?|font-style: italic; ?|text-decoration: line-through; ?){3}">([\w\W]*?)<\/span>/gm,"<del><strong><em>$2</em></strong></del>"],[/<span style="(font-weight: bold; ?|font-style: italic; ?|text-decoration: underline line-through; ?){3}">([\w\W]*?)<\/span>/gm,"<del><ins><strong><em>$2</em></strong></ins></del>"],[/<strong style="font-weight: normal;">([\w\W]*?)<\/strong>/gm,"$1"],[/<([a-z]+) style="font-weight: normal;">([\w\W]*?)<\/\1>/gm,"<$1>$2</$1>"],[/<([a-z]+) style="font-weight: bold;">([\w\W]*?)<\/\1>/gm,"<$1><strong>$2</strong></$1>"],[/<([a-z]+) style="font-style: italic;">([\w\W]*?)<\/\1>/gm,"<$1><em>$2</em></$1>"],[/<([a-z]+) style="text-decoration: underline;">([\w\W]*?)<\/\1>/gm,"<ins><$1>$2</$1></ins>"],[/<([a-z]+) style="text-decoration: line-through;">([\w\W]*?)<\/\1>/gm,"<del><$1>$2</$1></del>"],[/<([a-z]+) style="text-decoration: underline line-through;">([\w\W]*?)<\/\1>/gm,"<del><ins><$1>$2</$1></ins></del>"],[/<([a-z]+) style="(font-weight: bold; ?|font-style: italic; ?){2}">([\w\W]*?)<\/\1>/gm,"<$1><strong><em>$3</em></strong></$1>"],[/<([a-z]+) style="(font-weight: bold; ?|text-decoration: underline; ?){2}">([\w\W]*?)<\/\1>/gm,"<ins><$1><strong>$3</strong></$1></ins>"],[/<([a-z]+) style="(font-weight: italic; ?|text-decoration: underline; ?){2}">([\w\W]*?)<\/\1>/gm,"<ins><$1><em>$3</em></$1></ins>"],[/<([a-z]+) style="(font-weight: bold; ?|text-decoration: line-through; ?){2}">([\w\W]*?)<\/\1>/gm,"<del><$1><strong>$3</strong></$1></del>"],[/<([a-z]+) style="(font-weight: italic; ?|text-decoration: line-through; ?){2}">([\w\W]*?)<\/\1>/gm,"<del><$1><em>$3</em></$1></del>"],[/<([a-z]+) style="(font-weight: bold; ?|font-style: italic; ?|text-decoration: underline; ?){3}">([\w\W]*?)<\/\1>/gm,"<ins><$1><strong><em>$3</em></strong></$1></ins>"],[/<([a-z]+) style="(font-weight: bold; ?|font-style: italic; ?|text-decoration: line-through; ?){3}">([\w\W]*?)<\/\1>/gm,"<del><$1><strong><em>$3</em></strong></$1></del>"],[/<([a-z]+) style="(font-weight: bold; ?|font-style: italic; ?|text-decoration: underline line-through; ?){3}">([\w\W]*?)<\/\1>/gm,"<del><ins><$1><strong><em>$3</em></strong></$1></ins></del>"],[/<p><blockquote>(.*)(\n)+<\/blockquote><\/p>/i,"<blockquote>$1</blockquote>\n"],[/<\/(strong|em|ins|del|q|code)>(\s*?)<\1>/gim,"$2"],[/<(br|BR)>/g,"<br />"],[/<(hr|HR)>/g,"<hr />"],[/([^\s])\/>/g,"$1 />"],[/<br \/>\s*<\/(h1|h2|h3|h4|h5|h6|ul|ol|li|p|blockquote|div)/gi,"</$1"],[/<\/(h1|h2|h3|h4|h5|h6|ul|ol|li|p|blockquote)>([^\n\u000B\r\f])/gi,"</$1>\n$2"],[/<hr style="width: 100%; height: 2px;" \/>/g,"<hr />"],[/style="\s*?"/gim,""],[/<\s+/gim,"<"],[/\s+>/gim,">"]],removeFormat:function(e){return r.each(this.formatRegexp,function(t){e="".replace.apply(e,t)}),e},tagsoup2html:function(e){for(r.each(this.cleanRegexp,function(t){e="".replace.apply(e,t)});/(<[^\/!]>|<[^\/!][^>]*[^\/]>)\s*<\/[^>]*[^-]>/.test(e);)e=e.replace(/(<[^\/!]>|<[^\/!][^>]*[^\/]>)\s*<\/[^>]*[^-]>/g,"");e=e.replace(/<(\/?)([A-Z0-9]+)/g,function(e,t,n){return"<"+t+n.toLowerCase()});for(var t=/<[^>]+((\s+\w+\s*=\s*)([^"'][\w~@+$,%\/:.#?=&;!*()-]*))[^>]*?>/,n=function(e,t,n,o){var i=t.replace(/([\\\^\$*+[\]?{}.=!:(|)])/g,"\\$1");return e.replace(i,n+'"'+o+'"')};t.test(e);)e=e.replace(t,n);for(;/(<[^>]+style=(["'])[^>]+[\s:]+)0(pt|px)(\2|\s|;)/.test(e);)e=e.replace(/(<[^>]+style=(["'])[^>]+[\s:]+)0(pt|px)(\2|\s|;)/gi,"$10$4");return e=e.replace(/\r\n/g,"\n"),e=e.replace(/^\s+/,"").replace(/\s+$/,"")},clean:function(e){return e=this.removeFormat(e),e=this.tagsoup2html(e)}});n.HtmlCleaner=a},{"./util":9}],7:[function(e,t,n){var o=e("../vendor/rangy/core"),i=e("./util")._;o.api.createCoreModule("RangyExtensions",[],function(e){e.selectionPrototype.getBoundaryNodes=function(){var e,t,n,o;for(this.isBackwards()?(e=this.focusNode,t=this.focusOffset,n=this.anchorNode,o=this.anchorOffset):(e=this.anchorNode,t=this.anchorOffset,n=this.focusNode,o=this.focusOffset),3===e.nodeType&&e.nextSibling&&e.length===t?e=e.nextSibling:1===e.nodeType&&e.childNodes.length>t&&(e=e.childNodes[t]);e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;for(3===n.nodeType&&n.previousSibling&&0===o?n=n.previousSibling:o>0&&1===n.nodeType&&n.childNodes.length>0&&(n=n.childNodes[o-1]);n.lastChild&&1===n.lastChild.nodeType;)n=n.lastChild;return e=e&&1!==e.nodeType?e.parentNode:e,n=n&&1!==n.nodeType?n.parentNode:n,{start:e,end:n}},e.selectionPrototype.getEnclosingNode=function(){var t,n=this.getBoundaryNodes();return t=n.start===n.end?n.start:e.dom.getCommonAncestor(n.start,n.end),e.dom.getDeepestNode(t)},e.selectionPrototype.getTopNodes=function(e,t){e=e||document.body;var n=this.getEnclosingNode(),o=[n];if(n===e)return[];for(;n.parentNode!==e;)n=n.parentNode,o.push(n);return"function"==typeof t?i.filter(o,t):o},e.selectionPrototype.getSurroundingNodes=function(t){var n,o=this.getBoundaryNodes(),r=this.getEnclosingNode(),a=!1,s=[];if(e.dom.isAncestorOf(o.start,o.end,!0))return[o.start];if(e.dom.isAncestorOf(o.end,o.start,!0))return[o.end];for(var l=0;l<r.childNodes.length&&(n=r.childNodes[l],a||(a=e.dom.isAncestorOf(n,o.start,!0)),a&&s.push(n),!e.dom.isAncestorOf(n,o.end,!0));l++);return"function"==typeof t?i.filter(s,t):s},e.dom.hasParents=function(e,t){for(;-1===[document,document.body].indexOf(e)&&null!=e;){if(-1!==t.indexOf(e))return!0;e=e.parentNode}return!1},e.dom.getDeepestNode=function(e){for(;1===e.childNodes.length&&1===e.firstChild.nodeType;)e=e.firstChild;return e},e.dom.replaceNodeByContents=function(e){var t=this.getDocument(e).createDocumentFragment();i.each(e.childNodes,function(e){t.appendChild(e.cloneNode(!0))}),e.parentNode.replaceChild(t,e)},e.dom.getNodes=function(t,n,o){var i=[];o||"undefined"!=typeof n&&t.nodeType!==n||i.push(t);for(var r=0;r<t.childNodes.length;r++)("undefined"==typeof n||t.childNodes[r].nodeType===n)&&i.push(t.childNodes[r]),
[].push.apply(i,e.dom.getNodes(t.childNodes[r],n,!0));return i}})},{"../vendor/rangy/core":11,"./util":9}],8:[function(e,t,n){var o=e("./util"),i=e("./controls"),r=i.ControlsMixin,a=o.extend,s=o.Class,l=s(Object,{defaults:{classPrefix:"",fontAwesomeEnabled:!1},init:function(e,t){r.prototype.init.call(this),this.editor=e,this.options=a({},this.defaults,t||{}),this.element=document.createElement("div"),this.container=document.createElement("ul"),this.dialog=document.createElement("div"),this.container.classList.add(this._getClassName("controls")),this.element.classList.add(this._getClassName("toolbar")),document.body.appendChild(this.element),this.dialog.classList.add(this._getClassName("dialog")),this.dialog.style.display="none",this.element.appendChild(this.container),this.element.appendChild(this.dialog),this.element.style.visibility="hidden",this._showEvt=document.createEvent("Event"),this._showEvt.initEvent("toolbar.show",!1,!0),this._hideEvt=document.createEvent("Event"),this._hideEvt.initEvent("toolbar.hide",!1,!0),this._dirty=!1},_getClassName:function(e){return this.options.classPrefix+e},click:function(e){this.element.addEventListener("click",e)},focus:function(e){this.element.addEventListener("focus",e)},hide:function(){this.element.style.visibility="hidden",this.element.dispatchEvent(this._hideEvt)},show:function(){this._dirty&&this.drawControls(),this.element.style.visibility="visible",this.element.dispatchEvent(this._showEvt)},showDialog:function(){this.emptyDialog(),this.dialog.style.display="block",this.container.style.display="none"},hideDialog:function(){this.dialog.style.display="none",this.container.style.display="block"},emptyDialog:function(){for(;this.dialog.firstChild;)this.dialog.removeChild(this.dialog.firstChild)},move:function(e,t){this.element.style.top=e+"px",this.element.style.left=t+"px"},addControl:function(e,t,n){this.controls[t]=new e(this,t,n),this._dirty=!0},removeControl:function(e){this.controls[e]&&(r.prototype.removeControl.call(this,e),this._dirty=!0)},drawControls:function(){for(var e;this.container.firstChild;)this.container.removeChild(this.container.firstChild);for(var t in this.controls)e=this.controls[t],this.container.appendChild(e.drawElement());this._dirty=!1}});n.Toolbar=l},{"./controls":1,"./util":9}],9:[function(e,t,n){var o=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n="";("string"==typeof t||"boolean"==typeof t)&&(n=t===!0?"deep":t,t=e.shift(),"defaults"===n&&(t=o({},t),n="strict"));for(var i=0,r=e.length;r>i;i++){var a=e[i];for(var s in a)"deep"===n&&"object"==typeof a[s]&&"undefined"!=typeof t[s]?o(n,t[s],a[s]):("strict"!==n||"strict"===n&&"undefined"!=typeof t[s])&&(t[s]=a[s])}return t},i=function(e,t){var n=function(){"undefined"!=typeof this.init&&this.init.apply(this,arguments)},i=function(){};return i.prototype=e.prototype,n.prototype=new i,n.prototype.constructor=e,o(n.prototype,t),n},r={},a={},s=Array.prototype.forEach,l=Array.prototype.map,c=Array.prototype.filter;r.each=function(e,t,n){if(null==e)return e;if(s&&e.forEach===s)e.forEach(t,n);else if(e.length===+e.length){for(var o=0,i=e.length;i>o;o++)if(t.call(n,e[o],o,e)===a)return}else for(var l=r.keys(e),o=0,i=l.length;i>o;o++)if(t.call(n,e[l[o]],l[o],e)===a)return;return e},r.map=function(e,t,n){var o=[];return null==e?o:l&&e.map===l?e.map(t,n):(r.each(e,function(e,i,r){o.push(t.call(n,e,i,r))}),o)},r.filter=function(e,t,n){var o=[];return null==e?o:c&&e.filter===c?e.filter(t,n):(r.each(e,function(e,i,r){t.call(n,e,i,r)&&o.push(e)}),o)},n.extend=o,n.Class=i,n._=r},{}],10:[function(e,t,n){n.VERSION="0.3.0",n.rangy=e("./vendor/rangy/core").api,e("./vendor/rangy/dom"),e("./vendor/rangy/domrange"),e("./vendor/rangy/selectionsaverestore"),e("./vendor/rangy/wrappedrange"),e("./vendor/rangy/wrappedselection"),e("./lib/rangy-extensions"),n.extend=e("./lib/util").extend,n.Class=e("./lib/util").Class,n.HtmlCleaner=e("./lib/html-cleaner").HtmlCleaner,n.Editor=e("./lib/editor").Editor,n.controls=e("./lib/editor").controls,n.simpleEditor=e("./lib/editor").simpleEditor},{"./lib/editor":5,"./lib/html-cleaner":6,"./lib/rangy-extensions":7,"./lib/util":9,"./vendor/rangy/core":11,"./vendor/rangy/dom":12,"./vendor/rangy/domrange":13,"./vendor/rangy/selectionsaverestore":14,"./vendor/rangy/wrappedrange":15,"./vendor/rangy/wrappedselection":16}],11:[function(e,t,n){function o(e,t){var n=typeof e[t];return n==N||!(n!=R||!e[t])||"unknown"==n}function i(e,t){return!(typeof e[t]!=R||!e[t])}function r(e,t){return typeof e[t]!=w}function a(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}function s(e){return e&&_(e,T)&&x(e,S)}function l(e){return i(e,"body")?e.body:e.getElementsByTagName("body")[0]}function c(e){i(window,"console")&&o(window.console,"log")&&window.console.log(e)}function d(e,t){t?window.alert(e):c(e)}function u(e){A.initialized=!0,A.supported=!1,d("Rangy is not supported on this page in your browser. Reason: "+e,A.config.alertOnFail)}function f(e){d("Rangy warning: "+e,A.config.alertOnWarn)}function h(e){return e.message||e.description||String(e)}function g(){if(!A.initialized){var e,t=!1,n=!1;o(document,"createRange")&&(e=document.createRange(),_(e,b)&&x(e,E)&&(t=!0),e.detach());var i=l(document);if(!i||"body"!=i.nodeName.toLowerCase())return void u("No body element found");if(i&&o(i,"createTextRange")&&(e=i.createTextRange(),s(e)&&(n=!0)),!t&&!n)return void u("Neither Range nor TextRange are available");A.initialized=!0,A.features={implementsDomRange:t,implementsTextRange:n};var r,a;for(var d in D)(r=D[d])instanceof m&&r.init(r,A);for(var f=0,g=L.length;g>f;++f)try{L[f](A)}catch(p){a="Rangy init listener threw an exception. Continuing. Detail: "+h(p),c(a)}}}function p(e){e=e||window,g();for(var t=0,n=I.length;n>t;++t)I[t](e)}function m(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function v(e,t,n,o){var i=new m(t,n,function(e){if(!e.initialized){e.initialized=!0;try{o(A,e),e.supported=!0}catch(n){var i="Module '"+t+"' failed to load: "+h(n);c(i)}}});D[t]=i}function C(){}function y(){}var R="object",N="function",w="undefined",E=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],b=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],S=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],T=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],_=a(o),O=a(i),x=a(r),D={},A={version:"1.3alpha.804",initialized:!1,supported:!0,util:{isHostMethod:o,isHostObject:i,isHostProperty:r,areHostMethods:_,areHostObjects:O,areHostProperties:x,isTextRange:s,getBody:l},features:{},modules:D,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1}};A.fail=u,A.warn=f,{}.hasOwnProperty?A.util.extend=function(e,t,n){var o,i;for(var r in t)t.hasOwnProperty(r)&&(o=e[r],i=t[r],n&&null!==o&&"object"==typeof o&&null!==i&&"object"==typeof i&&A.util.extend(o,i,!0),e[r]=i);return e}:u("hasOwnProperty not supported"),function(){var e=document.createElement("div");e.appendChild(document.createElement("span"));var t,n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(e){return n.call(e,0)})}catch(o){}t||(t=function(e){for(var t=[],n=0,o=e.length;o>n;++n)t[n]=e[n];return t}),A.util.toArray=t}();var k;o(document,"addEventListener")?k=function(e,t,n){e.addEventListener(t,n,!1)}:o(document,"attachEvent")?k=function(e,t,n){e.attachEvent("on"+t,n)}:u("Document does not have required addEventListener or attachEvent method"),A.util.addListener=k;var L=[];A.init=g,A.addInitListener=function(e){A.initialized?e(A):L.push(e)};var I=[];A.addCreateMissingNativeApiListener=function(e){I.push(e)},A.createMissingNativeApi=p,m.prototype={init:function(e){for(var t,n,o=this.dependencies||[],i=0,r=o.length;r>i;++i){if(n=o[i],t=D[n],!(t&&t instanceof m))throw new Error("required module '"+n+"' not found");if(t.init(),!t.supported)throw new Error("required module '"+n+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){A.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){A.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},A.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]),v(!1,e,n,t)},A.createCoreModule=function(e,t,n){v(!0,e,t,n)},A.RangePrototype=C,A.rangePrototype=new C,A.selectionPrototype=new y,n.api=A},{}],12:[function(e,t,n){var o=e("./core");o.api.createCoreModule("DomUtil",[],function(e,t){function n(e){var t;return typeof e.namespaceURI==x||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function o(e){var t=e.parentNode;return 1==t.nodeType?t:null}function i(e){for(var t=0;e=e.previousSibling;)++t;return t}function r(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function a(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(L(o,n))return n;return null}function s(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function l(e,t){return s(e,t,!0)}function c(e,t,n){for(var o,i=n?e:e.parentNode;i;){if(o=i.parentNode,o===t)return i;i=o}return null}function d(e){var t=e.nodeType;return 3==t||4==t||8==t}function u(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function f(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function h(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),f(o,e),n)for(var r,a=0;r=n[a++];)r.node==e&&r.offset>t?(r.node=o,r.offset-=t):r.node==e.parentNode&&r.offset>i(e)&&++r.offset;return o}function g(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=x)return e.ownerDocument;if(typeof e.document!=x)return e.document;if(e.parentNode)return g(e.parentNode);throw t.createError("getDocument: no document found for node")}function p(e){var n=g(e);if(typeof n.defaultView!=x)return n.defaultView;if(typeof n.parentWindow!=x)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function m(e){if(typeof e.contentDocument!=x)return e.contentDocument;if(typeof e.contentWindow!=x)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function v(e){if(typeof e.contentWindow!=x)return e.contentWindow;if(typeof e.contentDocument!=x)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function C(e){return e&&D.isHostMethod(e,"setTimeout")&&D.isHostObject(e,"document")}function y(e,t,n){var o;if(e?D.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?m(e):g(e):C(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function R(e){for(var t;t=e.parentNode;)e=t;return e}function N(e,n,o,r){var s,l,d,u,f;if(e==o)return n===r?0:r>n?-1:1;if(s=c(o,e,!0))return n<=i(s)?-1:1;if(s=c(e,o,!0))return i(s)<r?-1:1;if(l=a(e,o),!l)throw new Error("comparePoints error: nodes have no common ancestor");if(d=e===l?l:c(e,l,!0),u=o===l?l:c(o,l,!0),d===u)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(f=l.firstChild;f;){if(f===d)return-1;if(f===u)return 1;f=f.nextSibling}}function w(e){try{return e.parentNode,!1}catch(t){return!0}}function E(e){if(!e)return"[No node]";if(I&&w(e))return"[Broken node]";if(d(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+i(e)+"]["+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function b(e){for(var t,n=g(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function S(e){this.root=e,this._next=e}function T(e){return new S(e)}function _(e,t){this.node=e,this.offset=t}function O(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var x="undefined",D=e.util;D.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),D.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var A=document.createElement("div");D.areHostMethods(A,["insertBefore","appendChild","cloneNode"]||!D.areHostObjects(A,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),D.isHostProperty(A,"innerHTML")||t.fail("Element is missing innerHTML property");var k=document.createTextNode("test");D.areHostMethods(k,["splitText","deleteData","insertData","appendData","cloneNode"]||!D.areHostObjects(A,["previousSibling","nextSibling","childNodes","parentNode"])||!D.areHostProperties(k,["data"]))||t.fail("Incomplete Text Node implementation");var L=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},I=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br>",I=w(n),e.features.crashyTextNodes=I}();var B;typeof window.getComputedStyle!=x?B=function(e,t){return p(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=x?B=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found"),S.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},_.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+E(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},O.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},O.prototype.toString=function(){return this.message},e.dom={arrayContains:L,isHtmlNamespace:n,parentElement:o,getNodeIndex:i,getNodeLength:r,getCommonAncestor:a,isAncestorOf:s,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:d,isTextOrCommentNode:u,insertAfter:f,splitDataNode:h,getDocument:g,getWindow:p,getIframeWindow:v,getIframeDocument:m,getBody:D.getBody,isWindow:C,getContentDocument:y,getRootContainer:R,comparePoints:N,isBrokenNode:w,inspectNode:E,getComputedStyleProperty:B,fragmentFromNodeChildren:b,createIterator:T,DomPosition:_},e.DOMException=O})},{"./core":11}],13:[function(e,t,n){var o=e("./core");o.api.createCoreModule("DomRange",["DomUtil"],function(e,t){function n(e,t){return 3!=e.nodeType&&(q(e,t.startContainer)||q(e,t.endContainer))}function o(e){return e.document||U(e.startContainer)}function i(e){return new M(e.parentNode,F(e))}function r(e){return new M(e.parentNode,F(e)+1)}function a(e,t,n){var o=11==e.nodeType?e.firstChild:e;return z(t)?n==t.length?$.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:K(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function s(e,t,n){if(_(e),_(t),o(t)!=o(e))throw new W("WRONG_DOCUMENT_ERR");var i=j(e.startContainer,e.startOffset,t.endContainer,t.endOffset),r=j(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?0>=i&&r>=0:0>i&&r>0}function l(e){for(var t,n,i,r=o(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(i=e.getSubtreeIterator(),n.appendChild(l(i)),i.detach(!0)),10==n.nodeType)throw new W("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function c(e,t,n){var o,i;n=n||{stop:!1};for(var r,a;r=e.next();)if(e.isPartiallySelectedSubtree()){if(t(r)===!1)return void(n.stop=!0);if(a=e.getSubtreeIterator(),c(a,t,n),a.detach(!0),n.stop)return}else for(o=$.createIterator(r);i=o.next();)if(t(i)===!1)return void(n.stop=!0)}function d(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),d(t),t.detach(!0)):e.remove()}function u(e){for(var t,n,i=o(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(u(n)),n.detach(!0)):e.remove(),10==t.nodeType)throw new W("HIERARCHY_REQUEST_ERR");i.appendChild(t)}return i}function f(e,t,n){var o,i=!(!t||!t.length),r=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var a=[];return c(new g(e,!1),function(t){if((!i||o.test(t.nodeType))&&(!r||n(t))){var s=e.startContainer;if(t!=s||!z(s)||e.startOffset!=s.length){var l=e.endContainer;t==l&&z(l)&&0==e.endOffset||a.push(t)}}}),a}function h(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+$.inspectNode(e.startContainer)+":"+e.startOffset+", "+$.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function g(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&z(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||z(this.sc)?V(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||z(this.ec)?V(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function p(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function m(e){return function(t,n){for(var o,i=n?t:t.parentNode;i;){if(o=i.nodeType,Q(e,o))return i;i=i.parentNode}return null}}function v(e,t){if(re(e,t))throw new p("INVALID_NODE_TYPE_ERR")}function C(e){if(!e.startContainer)throw new W("INVALID_STATE_ERR")}function y(e,t){if(!Q(t,e.nodeType))throw new p("INVALID_NODE_TYPE_ERR")}function R(e,t){if(0>t||t>(z(e)?e.length:e.childNodes.length))throw new W("INDEX_SIZE_ERR")}function N(e,t){if(oe(e,!0)!==oe(t,!0))throw new W("WRONG_DOCUMENT_ERR")}function w(e){if(ie(e,!0))throw new W("NO_MODIFICATION_ALLOWED_ERR")}function E(e,t){if(!e)throw new W(t)}function b(e){return Z&&$.isBrokenNode(e)||!Q(J,e.nodeType)&&!oe(e,!0)}function S(e,t){return t<=(z(e)?e.length:e.childNodes.length)}function T(e){return!!e.startContainer&&!!e.endContainer&&!b(e.startContainer)&&!b(e.endContainer)&&S(e.startContainer,e.startOffset)&&S(e.endContainer,e.endOffset)}function _(e){if(C(e),!T(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function O(e,t){_(e);var n=e.startContainer,o=e.startOffset,i=e.endContainer,r=e.endOffset,a=n===i;z(i)&&r>0&&r<i.length&&K(i,r,t),z(n)&&o>0&&o<n.length&&(n=K(n,o,t),a?(r-=o,i=n):i==n.parentNode&&r>=F(n)&&r++,o=0),e.setStartAndEnd(n,o,i,r)}function x(e){e.START_TO_START=ue,e.START_TO_END=fe,e.END_TO_END=he,e.END_TO_START=ge,e.NODE_BEFORE=pe,e.NODE_AFTER=me,e.NODE_BEFORE_AND_AFTER=ve,e.NODE_INSIDE=Ce}function D(e){x(e),x(e.prototype)}function A(e,t){return function(){_(this);var n,o,i=this.startContainer,a=this.startOffset,s=this.commonAncestorContainer,l=new g(this,!0);i!==s&&(n=V(i,s,!0),o=r(n),i=o.node,a=o.offset),c(l,w),l.reset();var d=e(l);return l.detach(),t(this,i,a,i,a),d}}function k(t,o,a){function s(e,t){return function(n){C(this),y(n,X),y(G(n),J);var o=(e?i:r)(n);(t?l:c)(this,o.node,o.offset)}}function l(e,t,n){var i=e.endContainer,r=e.endOffset;(t!==e.startContainer||n!==e.startOffset)&&((G(t)!=G(i)||1==j(t,n,i,r))&&(i=t,r=n),o(e,t,n,i,r))}function c(e,t,n){var i=e.startContainer,r=e.startOffset;(t!==e.endContainer||n!==e.endOffset)&&((G(t)!=G(i)||-1==j(t,n,i,r))&&(i=t,r=n),o(e,i,r,t,n))}var f=function(){};f.prototype=e.rangePrototype,t.prototype=new f,H.extend(t.prototype,{setStart:function(e,t){C(this),v(e,!0),R(e,t),l(this,e,t)},setEnd:function(e,t){C(this),v(e,!0),R(e,t),c(this,e,t)},setStartAndEnd:function(){C(this);var e=arguments,t=e[0],n=e[1],i=t,r=n;switch(e.length){case 3:r=e[2];break;case 4:i=e[2],r=e[3]}o(this,t,n,i,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){_(this),e?o(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):o(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){C(this),v(e,!0),o(this,e,0,e,Y(e))},selectNode:function(e){C(this),v(e,!1),y(e,X);var t=i(e),n=r(e);o(this,t.node,t.offset,n.node,n.offset)},extractContents:A(u,o),deleteContents:A(d,o),canSurroundContents:function(){_(this),w(this.startContainer),w(this.endContainer);var e=new g(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},detach:function(){a(this)},splitBoundaries:function(){O(this)},splitBoundariesPreservingPositions:function(e){O(this,e)},normalizeBoundaries:function(){_(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,r=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},a=function(o){var r=o.previousSibling;if(r&&r.nodeType==o.nodeType){e=o;var a=o.length;if(t=r.length,o.insertData(0,r.data),r.parentNode.removeChild(r),e==n)i+=t,n=e;else if(n==o.parentNode){var s=F(o);i==s?(n=o,i=a):i>s&&i--}}},s=!0;if(z(n))n.length==i&&r(n);else{if(i>0){var l=n.childNodes[i-1];l&&z(l)&&r(l)}s=!this.collapsed}if(s){if(z(e))0==t&&a(e);else if(t<e.childNodes.length){var c=e.childNodes[t];c&&z(c)&&a(c)}}else e=n,t=i;o(this,e,t,n,i)},collapseToPoint:function(e,t){C(this),v(e,!0),R(e,t),this.setStartAndEnd(e,t)}}),D(t)}function L(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:$.getCommonAncestor(e.startContainer,e.endContainer)}function I(e,t,n,o,i){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=i,e.document=$.getDocument(t),L(e)}function B(e){C(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=e.document=null,e.collapsed=e.commonAncestorContainer=null}function P(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,L(this)}var $=e.dom,H=e.util,M=$.DomPosition,W=e.DOMException,z=$.isCharacterDataNode,F=$.getNodeIndex,q=$.isOrIsAncestorOf,U=$.getDocument,j=$.comparePoints,K=$.splitDataNode,V=$.getClosestAncestorIn,Y=$.getNodeLength,Q=$.arrayContains,G=$.getRootContainer,Z=e.features.crashyTextNodes;g.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,z(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!z(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return n(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new P(o(this.range));var t=this._current,n=t,i=0,r=t,a=Y(t);q(t,this.sc)&&(n=this.sc,i=this.so),q(t,this.ec)&&(r=this.ec,a=this.eo),I(e,n,i,r,a)}return new g(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},p.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},p.prototype.toString=function(){return this.message};var X=[1,3,4,5,7,8,10],J=[2,9,11],ee=[5,6,10,12],te=[1,3,4,5,7,8,10,11],ne=[1,3,4,5,7,8],oe=m([9,11]),ie=m(ee),re=m([6,10,12]),ae=document.createElement("style"),se=!1;try{ae.innerHTML="<b>x</b>",se=3==ae.firstChild.nodeType}catch(le){}e.features.htmlParsingConforms=se;var ce=se?function(e){var t=this.startContainer,n=U(t);if(!t)throw new W("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:z(t)&&(o=$.parentElement(t)),o=null===o||"HTML"==o.nodeName&&$.isHtmlNamespace(U(o).documentElement)&&$.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1),o.innerHTML=e,$.fragmentFromNodeChildren(o)}:function(e){C(this);var t=o(this),n=t.createElement("body");return n.innerHTML=e,$.fragmentFromNodeChildren(n)},de=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ue=0,fe=1,he=2,ge=3,pe=0,me=1,ve=2,Ce=3;H.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){_(this),N(this.startContainer,t.startContainer);var n,o,i,r,a=e==ge||e==ue?"start":"end",s=e==fe||e==ue?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],i=t[s+"Container"],r=t[s+"Offset"],j(n,o,i,r)},insertNode:function(e){if(_(this),y(e,te),w(this.startContainer),q(e,this.startContainer))throw new W("HIERARCHY_REQUEST_ERR");var t=a(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){_(this);var e,t;if(this.collapsed)return o(this).createDocumentFragment();if(this.startContainer===this.endContainer&&z(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=o(this).createDocumentFragment(),t.appendChild(e),t;var n=new g(this,!0);return e=l(n),n.detach(),e},canSurroundContents:function(){_(this),w(this.startContainer),w(this.endContainer);var e=new g(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},surroundContents:function(e){if(y(e,ne),!this.canSurroundContents())throw new p("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);a(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){_(this);for(var e,t=new P(o(this)),n=de.length;n--;)e=de[n],t[e]=this[e];return t},toString:function(){_(this);var e=this.startContainer;if(e===this.endContainer&&z(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new g(this,!0);return c(n,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){_(this);var t=e.parentNode,n=F(e);if(!t)throw new W("NOT_FOUND_ERR");var o=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return 0>o?i>0?ve:pe:i>0?me:Ce},comparePoint:function(e,t){return _(this),E(e,"HIERARCHY_REQUEST_ERR"),N(e,this.startContainer),j(e,t,this.startContainer,this.startOffset)<0?-1:j(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ce,toHtml:function(){_(this);var e=this.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){if(_(this),E(e,"NOT_FOUND_ERR"),U(e)!==o(this))return!1;var n=e.parentNode,i=F(e);E(n,"NOT_FOUND_ERR");var r=j(n,i,this.endContainer,this.endOffset),a=j(n,i+1,this.startContainer,this.startOffset);return t?0>=r&&a>=0:0>r&&a>0},isPointInRange:function(e,t){return _(this),E(e,"HIERARCHY_REQUEST_ERR"),N(e,this.startContainer),j(e,t,this.startContainer,this.startOffset)>=0&&j(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return s(this,e,!1)},intersectsOrTouchesRange:function(e){return s(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=j(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=j(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==j(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==j(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new p("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==Ce},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,Y(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();t.setEnd(o,o.length);var i=this.containsRange(t);return t.detach(),i}return this.containsNodeContents(e)},getNodes:function(e,t){return _(this),f(this,e,t)},getDocument:function(){return o(this)},collapseBefore:function(e){C(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){C(this),this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var n=o(this),i=e.createRange(n);t=t||$.getBody(n),i.selectNodeContents(t);var r=this.intersection(i),a=0,s=0;return r&&(i.setEnd(r.startContainer,r.startOffset),a=i.toString().length,s=a+r.toString().length,i.detach()),{start:a,end:s,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,i,r,a,s=[t],l=!1,c=!1;!c&&(o=s.pop());)if(3==o.nodeType)i=n+o.length,!l&&e.start>=n&&e.start<=i&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=i&&(this.setEnd(o,e.end-n),c=!0),n=i;else for(a=o.childNodes,r=a.length;r--;)s.push(a[r])},getName:function(){return"DomRange"},equals:function(e){return P.rangesEqual(this,e)},isValid:function(){return T(this)},inspect:function(){return h(this)}}),k(P,I,B),H.extend(P,{rangeProperties:de,RangeIterator:g,copyComparisonConstants:D,createPrototypeRange:k,inspect:h,getRangeDocument:o,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=P,e.RangeException=p})},{"./core":11}],14:[function(e,t,n){var o=e("./core");o.api.createModule("SaveRestore",["WrappedRange"],function(e,t){function n(e,t){return(t||document).getElementById(e)}function o(e,t){var n,o="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),i=g.getDocument(e.startContainer),r=e.cloneRange();return r.collapse(t),n=i.createElement("span"),n.id=o,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(i.createTextNode(p)),r.insertNode(n),r.detach(),n}function i(e,o,i,r){var a=n(i,e);a?(o[r?"setStartBefore":"setEndBefore"](a),a.parentNode.removeChild(a)):t.warn("Marker element has been removed. Cannot restore selection.")}function r(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function a(t,n){var i,r,a=e.DomRange.getRangeDocument(t),s=t.toString();return t.collapsed?(r=o(t,!1),{document:a,markerId:r.id,collapsed:!0}):(r=o(t,!1),i=o(t,!0),{document:a,startMarkerId:i.id,endMarkerId:r.id,collapsed:!1,backward:n,toString:function(){return"original text: '"+s+"', new text: '"+t.toString()+"'"}})}function s(o,r){var a=o.document;"undefined"==typeof r&&(r=!0);var s=e.createRange(a);if(o.collapsed){var l=n(o.markerId,a);if(l){l.style.display="inline";var c=l.previousSibling;c&&3==c.nodeType?(l.parentNode.removeChild(l),s.collapseToPoint(c,c.length)):(s.collapseBefore(l),l.parentNode.removeChild(l))}else t.warn("Marker element has been removed. Cannot restore selection.")}else i(a,s,o.startMarkerId,!0),i(a,s,o.endMarkerId,!1);return r&&s.normalizeBoundaries(),s}function l(t,o){var i,s,l=[];t=t.slice(0),t.sort(r);
for(var c=0,d=t.length;d>c;++c)l[c]=a(t[c],o);for(c=d-1;c>=0;--c)i=t[c],s=e.DomRange.getRangeDocument(i),i.collapsed?i.collapseAfter(n(l[c].markerId,s)):(i.setEndBefore(n(l[c].endMarkerId,s)),i.setStartAfter(n(l[c].startMarkerId,s)));return l}function c(n){if(!e.isSelectionValid(n))return t.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var o=e.getSelection(n),i=o.getAllRanges(),r=1==i.length&&o.isBackward(),a=l(i,r);return r?o.setSingleRange(i[0],"backward"):o.setRanges(i),{win:n,rangeInfos:a,restored:!1}}function d(e){for(var t=[],n=e.length,o=n-1;o>=0;o--)t[o]=s(e[o],!0);return t}function u(t,n){if(!t.restored){var o=t.rangeInfos,i=e.getSelection(t.win),r=d(o),a=o.length;1==a&&n&&e.features.selectionHasExtend&&o[0].backward?(i.removeAllRanges(),i.addRange(r[0],!0)):i.setRanges(r),t.restored=!0}}function f(e,t){var o=n(t,e);o&&o.parentNode.removeChild(o)}function h(e){for(var t,n=e.rangeInfos,o=0,i=n.length;i>o;++o)t=n[o],t.collapsed?f(e.doc,t.markerId):(f(e.doc,t.startMarkerId),f(e.doc,t.endMarkerId))}var g=e.dom,p="\ufeff";e.util.extend(e,{saveRange:a,restoreRange:s,saveRanges:l,restoreRanges:d,saveSelection:c,restoreSelection:u,removeMarkerElement:f,removeMarkers:h})})},{"./core":11}],15:[function(e,t,n){var o=e("./core");o.api.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,o,i=e.dom,r=e.util,a=i.DomPosition,s=e.DomRange,l=i.getBody,c=i.getContentDocument,d=i.isCharacterDataNode;if(e.features.implementsDomRange&&!function(){function o(e){for(var t,n=h.length;n--;)t=h[n],e[t]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function a(e,t,n,o,i){var r=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==o||e.endOffset!=i,s=!e.equals(e.nativeRange);(r||a||s)&&(e.setEnd(o,i),e.setStart(t,n))}function d(e){e.nativeRange.detach(),e.detached=!0;for(var t=h.length;t--;)e[h[t]]=null}var u,f,h=s.rangeProperties;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,o(this)},s.createPrototypeRange(n,a,d),u=n.prototype,u.selectNode=function(e){this.nativeRange.selectNode(e),o(this)},u.cloneContents=function(){return this.nativeRange.cloneContents()},u.surroundContents=function(e){this.nativeRange.surroundContents(e),o(this)},u.collapse=function(e){this.nativeRange.collapse(e),o(this)},u.cloneRange=function(){return new n(this.nativeRange.cloneRange())},u.refresh=function(){o(this)},u.toString=function(){return this.nativeRange.toString()};var g=document.createTextNode("test");l(document).appendChild(g);var p=document.createRange();p.setStart(g,0),p.setEnd(g,0);try{p.setStart(g,1),u.setStart=function(e,t){this.nativeRange.setStart(e,t),o(this)},u.setEnd=function(e,t){this.nativeRange.setEnd(e,t),o(this)},f=function(e){return function(t){this.nativeRange[e](t),o(this)}}}catch(m){u.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}o(this)},u.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}o(this)},f=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(i){this.nativeRange[t](n),this.nativeRange[e](n)}o(this)}}}u.setStartBefore=f("setStartBefore","setEndBefore"),u.setStartAfter=f("setStartAfter","setEndAfter"),u.setEndBefore=f("setEndBefore","setStartBefore"),u.setEndAfter=f("setEndAfter","setStartAfter"),u.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},p.selectNodeContents(g),p.setEnd(g,3);var v=document.createRange();v.selectNodeContents(g),v.setEnd(g,4),v.setStart(g,2),-1==p.compareBoundaryPoints(p.START_TO_END,v)&&1==p.compareBoundaryPoints(p.END_TO_START,v)?u.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:u.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var C=document.createElement("div");C.innerHTML="123";var y=C.firstChild,R=l(document);R.appendChild(C),p.setStart(y,1),p.setEnd(y,2),p.deleteContents(),"13"==y.data&&(u.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},u.extractContents=function(){var e=this.nativeRange.extractContents();return o(this),e}),R.removeChild(C),R=null,r.isHostMethod(p,"createContextualFragment")&&(u.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(g),p.detach(),v.detach(),u.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),e.createRange()}}(),e.features.implementsTextRange){var u=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();n=e.duplicate(),n.collapse(!1);var r=n.parentElement(),a=o==r?o:i.getCommonAncestor(o,r);return a==t?a:i.getCommonAncestor(t,a)},f=function(e){return 0==e.compareEndPoints("StartToEnd",e)},h=function(e,t,n,o,r){var s=e.duplicate();s.collapse(n);var l=s.parentElement();if(i.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var c=new a(l.parentNode,i.getNodeIndex(l));return{boundaryPosition:c,nodeInfo:{nodeIndex:c.offset,containerElement:c.node}}}var u=i.getDocument(l).createElement("span");u.parentNode&&u.parentNode.removeChild(u);for(var f,h,g,p,m,v=n?"StartToStart":"StartToEnd",C=r&&r.containerElement==l?r.nodeIndex:0,y=l.childNodes.length,R=y,N=R;;){if(N==y?l.appendChild(u):l.insertBefore(u,l.childNodes[N]),s.moveToElementText(u),f=s.compareEndPoints(v,e),0==f||C==R)break;if(-1==f){if(R==C+1)break;C=N}else R=R==C+1?C:N;N=Math.floor((C+R)/2),l.removeChild(u)}if(m=u.nextSibling,-1==f&&m&&d(m)){s.setEndPoint(n?"EndToStart":"EndToEnd",e);var w;if(/[\r\n]/.test(m.data)){var E=s.duplicate(),b=E.text.replace(/\r\n/g,"\r").length;for(w=E.moveStart("character",b);-1==(f=E.compareEndPoints("StartToEnd",E));)w++,E.moveStart("character",1)}else w=s.text.length;p=new a(m,w)}else h=(o||!n)&&u.previousSibling,g=(o||n)&&u.nextSibling,p=g&&d(g)?new a(g,0):h&&d(h)?new a(h,h.data.length):new a(l,i.getNodeIndex(u));return u.parentNode.removeChild(u),{boundaryPosition:p,nodeInfo:{nodeIndex:N,containerElement:l}}},g=function(e,t){var n,o,r,a,s=e.offset,c=i.getDocument(e.node),u=l(c).createTextRange(),f=d(e.node);return f?(n=e.node,o=n.parentNode):(a=e.node.childNodes,n=s<a.length?a[s]:null,o=e.node),r=c.createElement("span"),r.innerHTML="&#feff;",n?o.insertBefore(r,n):o.appendChild(r),u.moveToElementText(r),u.collapse(!t),o.removeChild(r),f&&u[t?"moveStart":"moveEnd"]("character",s),u};if(o=function(e){this.textRange=e,this.refresh()},o.prototype=new s(document),o.prototype.refresh=function(){var e,t,n,o=u(this.textRange);f(this.textRange)?t=e=h(this.textRange,o,!0,!0).boundaryPosition:(n=h(this.textRange,o,!0,!1),e=n.boundaryPosition,t=h(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(o),o.rangeToTextRange=function(e){if(e.collapsed)return g(new a(e.startContainer,e.startOffset),!0);var t=g(new a(e.startContainer,e.startOffset),!0),n=g(new a(e.endContainer,e.endOffset),!1),o=l(s.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var p=function(){return this}();"undefined"==typeof p.Range&&(p.Range=o),e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=c(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=c(e,t,"createRangyRange"),new s(e)},e.createIframeRange=function(n){return t.deprecationNotice("createIframeRange()","createRange(iframeEl)"),e.createRange(n)},e.createIframeRangyRange=function(n){return t.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),e.createRangyRange(n)},e.addCreateMissingNativeApiListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})})},{"./core":11}],16:[function(e,t,n){var o=e("./core");o.api.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){function n(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function o(e,n){if(e){if(O.isWindow(e))return e;if(e instanceof v)return e.win;var o=O.getContentDocument(e,t,n);return O.getWindow(o)}return window}function i(e){return o(e,"getWinSelection").getSelection()}function r(e){return o(e,"getDocSelection").document.selection}function a(e){var t=!1;return e.anchorNode&&(t=1==O.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function s(e,t,n){var o=n?"end":"start",i=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function l(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function c(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function d(t){var n;return t instanceof A?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof k?n=t.nativeRange:B.implementsDomRange&&t instanceof O.getWindow(t.startContainer).Range&&(n=t),n}function u(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;n>t;++t)if(!O.isAncestorOf(e[0],e[t]))return!1;return!0}function f(e){var n=e.getNodes();if(!u(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function h(e){return!!e&&"undefined"!=typeof e.text}function g(e,t){var n=new k(t);e._ranges=[n],s(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function p(t){if(t._ranges.length=0,"None"==t.docSelection.type)c(t);else{var n=t.docSelection.createRange();if(h(n))g(t,n);else{t.rangeCount=n.length;for(var o,i=$(n.item(0)),r=0;r<t.rangeCount;++r)o=e.createRange(i),o.selectNode(n.item(r)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,s(t,t._ranges[t.rangeCount-1],!1)}}}function m(e,n){for(var o=e.docSelection.createRange(),i=f(n),r=$(o.item(0)),a=H(r).createControlRange(),s=0,l=o.length;l>s;++s)a.add(o.item(s));try{a.add(i)}catch(c){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),p(e)}function v(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function C(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function y(e,t){for(var n,o,i=te.length;i--;)if(n=te[i],o=n.selection,"deleteAll"==t)C(o);else if(n.win==e)return"delete"==t?(te.splice(i,1),!0):o;return"deleteAll"==t&&(te.length=0),null}function R(e,n){for(var o,i=$(n[0].startContainer),r=H(i).createControlRange(),a=0,s=n.length;s>a;++a){o=f(n[a]);try{r.add(o)}catch(l){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),p(e)}function N(e,t){if(e.win.document!=$(t))throw new L("WRONG_DOCUMENT_ERR")}function w(t){return function(n,o){var i;this.rangeCount?(i=this.getRangeAt(0),i["set"+(t?"Start":"End")](n,o)):(i=e.createRange(this.win.document),i.setStartAndEnd(n,o)),this.setSingleRange(i,this.isBackward())}}function E(e){var t=[],n=new I(e.anchorNode,e.anchorOffset),o=new I(e.focusNode,e.focusOffset),i="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var r=0,a=e.rangeCount;a>r;++r)t[r]=A.inspect(e.getRangeAt(r));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}e.config.checkSelectionRanges=!0;var b,S,T="boolean",_="number",O=e.dom,x=e.util,D=x.isHostMethod,A=e.DomRange,k=e.WrappedRange,L=e.DOMException,I=O.DomPosition,B=e.features,P="Control",$=O.getDocument,H=O.getBody,M=A.rangesEqual,W=D(window,"getSelection"),z=x.isHostObject(document,"selection");B.implementsWinGetSelection=W,B.implementsDocSelection=z;var F=z&&(!W||e.config.preferTextRange);F?(b=r,e.isSelectionValid=function(e){var t=o(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||$(n.createRange().parentElement())==t}):W?(b=i,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=b;var q=b(),U=e.createNativeRange(document),j=H(document),K=x.areHostProperties(q,["anchorNode","focusNode","anchorOffset","focusOffset"]);B.selectionHasAnchorAndFocus=K;var V=D(q,"extend");B.selectionHasExtend=V;var Y=typeof q.rangeCount==_;B.selectionHasRangeCount=Y;var Q=!1,G=!0,Z=V?function(t,n){var o=A.getRangeDocument(n),i=e.createRange(o);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(d(i)),t.extend(n.startContainer,n.startOffset)}:null;x.areHostMethods(q,["addRange","getRangeAt","removeAllRanges"])&&typeof q.rangeCount==_&&B.implementsDomRange&&!function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,i=[],r=a(t),s=0;n>s;++s)i[s]=t.getRangeAt(s);var l=H(document),c=l.appendChild(document.createElement("div"));c.contentEditable="false";var d=c.appendChild(document.createTextNode("   ")),u=document.createRange();if(u.setStart(d,1),u.collapse(!0),t.addRange(u),G=1==t.rangeCount,t.removeAllRanges(),!o){var f=u.cloneRange();u.setStart(d,0),f.setEnd(d,3),f.setStart(d,2),t.addRange(u),t.addRange(f),Q=2==t.rangeCount,f.detach()}for(l.removeChild(c),t.removeAllRanges(),u.detach(),s=0;n>s;++s)0==s&&r?Z?Z(t,i[s]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because browser does not support Selection.extend"),t.addRange(i[s])):t.addRange(i[s])}}(),B.selectionSupportsMultipleRanges=Q,B.collapsedNonEditableSelectionsSupported=G;var X,J=!1;j&&D(j,"createControlRange")&&(X=j.createControlRange(),x.areHostProperties(X,["item","add"])&&(J=!0)),B.implementsControlRange=J,S=K?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var ee;D(q,"getRangeAt")?ee=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:K&&(ee=function(t){var n=$(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),v.prototype=e.selectionPrototype;var te=[],ne=function(e){if(e&&e instanceof v)return e.refresh(),e;e=o(e,"getNativeSelection");var t=y(e),n=b(e),i=z?r(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh()):(t=new v(n,i,e),te.push({win:e,selection:t})),t};e.getSelection=ne,e.getIframeSelection=function(n){return t.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),e.getSelection(O.getIframeWindow(n))};var oe=v.prototype;if(!F&&K&&x.areHostMethods(q,["removeAllRanges","addRange"])){oe.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)};var ie=function(e,t){Z(e.nativeSelection,t),e.refresh()};Y?oe.addRange=function(t,o){if(J&&z&&this.docSelection.type==P)m(this,t);else if(n(o)&&V)ie(this,t);else{var i;if(Q?i=this.rangeCount:(this.removeAllRanges(),i=0),this.nativeSelection.addRange(d(t).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==i+1){if(e.config.checkSelectionRanges){var r=ee(this.nativeSelection,this.rangeCount-1);r&&!M(r,t)&&(t=new k(r))}this._ranges[this.rangeCount-1]=t,s(this,t,se(this.nativeSelection)),this.isCollapsed=S(this)}else this.refresh()}}:oe.addRange=function(e,t){n(t)&&V?ie(this,e):(this.nativeSelection.addRange(d(e)),this.refresh())},oe.setRanges=function(e){if(J&&e.length>1)R(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;n>t;++t)this.addRange(e[t])}}}else{if(!(D(q,"empty")&&D(U,"select")&&J&&F))return t.fail("No means of selecting a Range or TextRange was found"),!1;oe.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=$(this.anchorNode);else if(this.docSelection.type==P){var t=this.docSelection.createRange();t.length&&(e=$(t.item(0)))}if(e){var n=H(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(o){}c(this)},oe.addRange=function(t){this.docSelection.type==P?m(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,s(this,t,!1))},oe.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?R(this,e):t&&this.addRange(e[0])}}oe.getRangeAt=function(e){if(0>e||e>=this.rangeCount)throw new L("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var re;if(F)re=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=H(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==P?p(t):h(n)?g(t,n):c(t)};else if(D(q,"getRangeAt")&&typeof q.rangeCount==_)re=function(t){if(J&&z&&t.docSelection.type==P)p(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;o>n;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));s(t,t._ranges[t.rangeCount-1],se(t.nativeSelection)),t.isCollapsed=S(t)}else c(t)};else{if(!K||typeof q.isCollapsed!=T||typeof U.collapsed!=T||!B.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;re=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=ee(n,0),e._ranges=[t],e.rangeCount=1,l(e),e.isCollapsed=S(e)):c(e)}}oe.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(re(this),e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;i--;)if(!M(t[i],this._ranges[i]))return!0;return!1}};var ae=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,i=n.length;i>o;++o)M(t,n[o])||e.addRange(n[o]);e.rangeCount||c(e)};J?oe.removeRange=function(e){if(this.docSelection.type==P){for(var t,n=this.docSelection.createRange(),o=f(e),i=$(n.item(0)),r=H(i).createControlRange(),a=!1,s=0,l=n.length;l>s;++s)t=n.item(s),t!==o||a?r.add(n.item(s)):a=!0;r.select(),p(this)}else ae(this,e)}:oe.removeRange=function(e){ae(this,e)};var se;!F&&K&&B.implementsDomRange?(se=a,oe.isBackward=function(){return se(this)}):se=oe.isBackward=function(){return!1},oe.isBackwards=oe.isBackward,oe.toString=function(){for(var e=[],t=0,n=this.rangeCount;n>t;++t)e[t]=""+this._ranges[t];return e.join("")},oe.collapse=function(t,n){N(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},oe.collapseToStart=function(){if(!this.rangeCount)throw new L("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},oe.collapseToEnd=function(){if(!this.rangeCount)throw new L("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},oe.selectAllChildren=function(t){N(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},oe.deleteFromDocument=function(){if(J&&z&&this.docSelection.type==P){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,i=n.length;i>o;++o)n[o].deleteContents();this.addRange(n[i-1])}}},oe.eachRange=function(e,t){for(var n=0,o=this._ranges.length;o>n;++n)if(e(this.getRangeAt(n)))return t},oe.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},oe.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},oe.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(o){n.push(o[e].apply(o,t))}),n},oe.setStart=w(!0),oe.setEnd=w(!1),e.rangePrototype.select=function(e){ne(this.getDocument()).setSingleRange(this,e)},oe.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},oe.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)},oe.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},oe.moveToBookmark=function(t){for(var n,o,i=[],r=0;n=t.rangeBookmarks[r++];)o=e.createRange(this.win),o.moveToBookmark(n),i.push(o);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},oe.toHtml=function(){return this.callMethodOnEachRange("toHtml").join("")},oe.getName=function(){return"WrappedSelection"},oe.inspect=function(){return E(this)},oe.detach=function(){y(this.win,"delete"),C(this)},v.detachAll=function(){y(null,"deleteAll")},v.inspect=E,v.isDirectionBackward=n,e.Selection=v,e.selectionPrototype=oe,e.addCreateMissingNativeApiListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ne(e)}),e=null})})},{"./core":11}]},{},[10])(10)});
//# sourceMappingURL=minislate.min.js.map
